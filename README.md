# About-the-Java
자바에 대한 것들을 정리해 두는 저장소

## 자바에서의 메모리 영역

자바에서의 메모리 영역은 클래스 영역, 스택 영역, 힙 영역의 3개 영역으로 나뉩니다. 

### 클래스 영역
프로그램의  흐름을 구성하는 바이트코드가 저장되는 영역입니다.
대표적으로 클래스에 대한 정보가 있으며 다음과 같은 것들이 저장됩니다.

* 필드 정보 : 클래스의 멤버변수 이름, 자료형, 접근제어자에 대한 정보

* 메소드 정보 : 클래스의 메소드 이름, 리턴 타입과 매개변수, 그리고 접근제어자에 대한 정보

* 클래스 또는 인터페이스의 타입 정보 :
  + 클래스 또는 인터페이스의 전체 이름 (패키지명 + 클래스명)
  + 클래스 또는 인터페이스가 상속받는 클래스 또는 인터페이스의 전체 이름
    * 단, 상속받는 것이 Interface(인터페이스의 최상위 인터페이스)이거나 Object(클래스의 최상위 클래스)일 경우는 제외
    
* 상수 풀 
    + 클래스 또는 인터페이스에서 사용도는 상수들을 저장
    
* 클래스 변수 (static 변수라고도 함)
    + 이 변수는 해당 클래스로 구현된 모든 객체가 공유할 수 있으며, 객체 생성 없이도 접근이 가능

### 스택 영역
LIFO방식으로 작동하는 메모리 영역이며, 이 영역에서는 다음과 같은 것들이 저장됩니다.

* 메서드가 호출될때 마다 각 메서드가 사용하는 공간(스택프레임)이 생성되어 이곳에 저장
  + 스택프레임들은 다음과 같은 것들이 임시적으로 저장
    * 메소드 내에서 사용되는 값들
    * 호출된 메소드의 매개변수, 지역변수,리턴 값
    * 연산시 생기는 값
    
* 스택프레임은 메서드 수행이 끝나면 삭제

### 힙 영역
new 연산자를 통해 생성된 객체와 배열을 저장하는 공간입니다.  
클래스 영역에 로드된 클래스들의 객체만 생성 가능하며, 이 영역은 아래에서 설명할 GC(Garbage Collector)에 의해 관리됩니다.
힙 영역은 다시 Young 영역과 Old영역으로 나뉘는데, 이는 아래의 GC에서 설명합니다.

### 그 외의 알아두면 좋은 영역
1. 네이티브 메소드 영역(Native Method Area)
  이 영역은 자라가 아닌 다른 언어로 만들어진 코드들이 저장되는 공간입니다.
  
2. PC 레지스터  
  CPU에서 말하는 PC와는 다릅니다.  
  자바에서 스레드가 생성될때마다 생기는 공간으로, 스레드가 실행할 명령어가 기록되어 있습니다.  
  스레드가 실행되는 부분의 명령과 주소를 저장합니다.

## GC(Garbage Collector)
GC는 힙 영역에 저장되어있는 객체들의 메모리를 관리하는 역할을 합니다.  
자바에서 객체는 힙 영역에서 각자의 메모리 공간을 점유하고 있으며, 해당 객체가 더이상 참조되지 않아 더 이상 쓸 필요가 없어지면 GC가 이런 객체들이 점유하는 메모리를 해제해 공간을 확보합니다.

앞서 설명한 힙 영역은 다시 다음과 같이 분류됩니다.
1. Young 영역  
  일반적으로 생성되지 얼마 안된 객체들이 점유하고 있는 영역입니다.  
  Young 영역은 다시 하나의 Eden 영역과 두 개의 Survivor 영역으로 구분됩니다.
  + Eden 영역  
    객체가 처음 생성될 때 해당 객체는 Eden영역에 저장됩니다.
  + Survivor 영역  
    Eden영역에 데이터가 어느정도 쌓이면 Eden 영역에 있던 데이터들 중 일부가 이 영역으로 옮겨집니다.  
    두 Survivor 영역 사이에 우선순위가 있는 것은 아니지만, 한 Survivor 영역이 다 차기 전까진 다른 하나는 비어있는 상태여야 합니다.  
    이 때, 데이터가 저장되어 있는 영역이 From, 비어있는 영역을 To 영역이라고도 합니다.  
    한 Survivor 영역의 메모리 공간이 차면, Eden 영역의 객체과 From 영역의 객체가 To 영역으로 이동하게 됩니다.  
    그러다 Young 영역에 공간이 없으면 Young 영역의 객체가 Old 영역으로 이동하게 됩니다.  

2. Old 영역  
  Young 영역이 다 차게 될 때 Young 영역의 객체가 이곳으로 옮겨집니다.
  
### GC의 종류
GC는 크게 두가지 종류로 나뉩니다.
1. 마이너 GC
  young 영역에서 일어나는 GC입니다.  
  Eden 영역의 공간이 다 차면 처음으로 발생하며, From 영역에 Eden영역의 객체들을 복사하고 나머지 객체들이 삭제됩니다.  
  Eden 영역과 From 영역에 메모리가 일정 수준 이상 찰 경우, Eden영역과 From 영역에 있는 객체 중 아직 참조중인 객체가 있는지 검사하고, 참조중인 객체는 To 영역으로 옮긴 뒤 나머지 영역의 객체를 삭제합니다.  
  그리고 일정 시간동안 참조되는 객체는 Old 영역으로 옮기며, 이 과정이 반복되면어 마이너 GC가 수행됩니다.
2. 메이저 GC  
  Old 영역에서 일어나는 GC입니다.  
  단순히 참조되지 않는 객체를 한번에 삭제하며, 마이너 GC에 비해 시간이 오래 걸립니다.  
  또한, 메이저 GC가 수행되는 동안엔 모든 프로세스가 중지되는 문제가 있습니다.
  
## 스레드(Thread)
일반적으로, 컴퓨터에서 실행 되는 각 프로그램을 프로세스라 하고 이 프로세스내에서 실행되는 각 작업을 스레드라 합니다.  
컴퓨터 환경에 따라 두개 이상의 스레드를 동시에 실행할 수 있으며, 이로 인해 프로그램의 실행 속도를 빠르게 할 수 있지만,  
반대로 동시에 여러 스레드가 실행되는데 있어 어떤 스레드가 먼저 수행 될지 알 수 없고, 이로 인해 실행마다 결과가 달라질 수 있어 오류가 생기기도 합니다.  
이를 해결하기 위해 스레드 실행 순서를 제어하는 여러 방법(세마포어, 뮤텍스 등)이 고안되어 왔고 자바에서도 스레드의 실행을 제어하는 여러 방법이 마련되어 있습니다.

### 자바에서의 스레드 사용
자바에서 스레드를 이용하기 위해서는 보통 다음 순서로 실행됩니다.

1. Thread 클래스 또는 Runnable 인터페이스를 상속받은 클래스를 생성
2. run 메소드 오버라이딩
3. 클래스를 인스턴스화
  + Thread 클래스를 상속받은 경우 : 바로 만들어두었던 클래스를 인스턴스화
  + Runnable 인터페이스를 상속받은 경우 : Thread 클래스의 생성자를 이용해 Thread 객체 생성
4. 만들어진 객체에서 start 메서드를 호출하면 스레드가 실행
